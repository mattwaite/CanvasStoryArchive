<!DOCTYPE html>
<html>
<head>
  <title>Canvas Connect</title>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

</head>
<body>

<script type="text/javascript" src="outfile.json"></script>
<script>


//console.log("inside load");

//store the return in data

function submit(){

//console.log("submit function is called");

//get article value and print
var article = $('#textEditor').val();
//console.log(article);

//send article

/* 
$.ajax({
	type:"POST",
	url: '/fulltext',
	data: {'text': article},
	success: 
	dataType: 'JSON'
})
*/

//set data
//data = JSON.parse(results);

var results =
[
    {
      "id": 2907,
      "entity_name": "Michael Brown",
      "entity_type": "Person",
      "category":"person",
      "entity_name_length": 2,
      "words_offset": 22,
      "stories": [
        {
          "large_image_url": "http://www.aljazeera.com/mritems/Images/2014/10/11/2014101153956741580_20.jpg",
          "byline": "Al Jazeera",
          "description": "A crowd of about 300 people gather outside police station in Missouri after another black teenager is shot dead. ",
          "pubdate": "2014-10-11T07:23:02",
          "headline": "Fresh protests in US over police violence",
          "small_image_url": "http://www.aljazeera.com/mritems/imagecache/318/480/mritems/Images/2014/10/11/2014101153956741580_20.jpg",
          "type": "earliest",
          "id": 3694,
          "video_url": null
        },
        {
          "large_image_url": "http://www.aljazeera.com/mritems/Images/2014/11/26/20141126223117823734_20.jpg",
          "byline": "Al Jazeera",
          "description": "Michael Brown's parents say jury's decision not to charge white officer who killed their unarmed son was \"unbelievable\".",
          "pubdate": "2014-11-27T07:01:34",
          "headline": "Family says Ferguson decision 'heartbreaking'",
          "small_image_url": "http://www.aljazeera.com/mritems/imagecache/318/480/mritems/Images/2014/11/26/20141126223117823734_20.jpg",
          "type": "video",
          "id": 320,
          "video_url": "http://bc05.ajnm.me/665003303001/201411/1747/665003303001_3912172556001_20141127-FERGUSON2-KSA-01D-27.mp4?videoId=3912149721001"
        },
        {
          "large_image_url": "http://www.aljazeera.com/mritems/Images/2014/11/26//201411267521599734_20.jpg",
          "byline": "Dexter Thomas ",
          "description": "There's a reason that Ferguson looks like a horror movie - the main character was a monster.",
          "pubdate": "2014-11-26T10:45:05",
          "headline": "Michael Brown was not a boy, he was a 'demon'",
          "small_image_url": "http://www.aljazeera.com/mritems/imagecache/318/480/mritems/Images/2014/11/26//201411267521599734_20.jpg",
          "type": "longest",
          "id": 351,
          "video_url": null
        },
        {
          "large_image_url": "http://www.aljazeera.com/mritems/Images/2014/11/29/201411296437903580_20.jpg",
          "byline": "Al Jazeera",
          "description": "Black Friday sales in New York, Chicago, Seattle and San Francisco disrupted by activists angered by jury decision.",
          "pubdate": "2014-11-29T07:40:34",
          "headline": "Ferguson protests target retailers across US",
          "small_image_url": "http://www.aljazeera.com/mritems/imagecache/318/480/mritems/Images/2014/11/29/201411296437903580_20.jpg",
          "type": "latest",
          "id": 242,
          "video_url": null
        },
        {
          "large_image_url": "http://www.aljazeera.com/mritems/Images/2014/11/29/201411296437903580_20.jpg",
          "byline": "Al Jazeera",
          "description": "Black Friday sales in New York, Chicago, Seattle and San Francisco disrupted by activists angered by jury decision.",
          "pubdate": "2014-11-29T07:40:34",
          "headline": "Ferguson protests target retailers across US",
          "small_image_url": "http://www.aljazeera.com/mritems/imagecache/318/480/mritems/Images/2014/11/29/201411296437903580_20.jpg",
          "type": "latest",
          "id": 243,
          "video_url": null
        },
        {
          "large_image_url": "http://www.aljazeera.com/mritems/Images/2014/11/29/201411296437903580_20.jpg",
          "byline": "Al Jazeera",
          "description": "Black Friday sales in New York, Chicago, Seattle and San Francisco disrupted by activists angered by jury decision.",
          "pubdate": "2014-11-29T07:40:34",
          "headline": "Ferguson protests target retailers across US",
          "small_image_url": "http://www.aljazeera.com/mritems/imagecache/318/480/mritems/Images/2014/11/29/201411296437903580_20.jpg",
          "type": "latest",
          "id": 244,
          "video_url": null
        },
        {
          "large_image_url": "http://www.aljazeera.com/mritems/Images/2014/11/29/201411296437903580_20.jpg",
          "byline": "Al Jazeera",
          "description": "Black Friday sales in New York, Chicago, Seattle and San Francisco disrupted by activists angered by jury decision.",
          "pubdate": "2014-11-29T07:40:34",
          "headline": "Ferguson protests target retailers across US",
          "small_image_url": "http://www.aljazeera.com/mritems/imagecache/318/480/mritems/Images/2014/11/29/201411296437903580_20.jpg",
          "type": "latest",
          "id": 245,
          "video_url": null
        }
      ]
    },
    {
      "id": 2913,
      "entity_name": "white police officer",
      "entity_type": "Position",
      "category":"thing",
      "entity_name_length": 3,
      "words_offset": 36,
      "stories": [
        {
          "large_image_url": "http://www.aljazeera.com/mritems/Images/2014/10/11/2014101153956741580_20.jpg",
          "byline": "Al Jazeera",
          "description": "A crowd of about 300 people gather outside police station in Missouri after another black teenager is shot dead. ",
          "pubdate": "2014-10-11T07:23:02",
          "headline": "Fresh protests in US over police violence",
          "small_image_url": "http://www.aljazeera.com/mritems/imagecache/318/480/mritems/Images/2014/10/11/2014101153956741580_20.jpg",
          "type": "earliest",
          "id": 3694,
          "video_url": null
        },
        {
          "large_image_url": "http://www.aljazeera.com/mritems/images/2014/11/26//20141126790145734_20.jpg",
          "byline": "Aram Goudsouzian",
          "description": "Many African Americans live in segregated neighbourhoods, endure a racially biased criminal justice system.",
          "pubdate": "2014-11-27T09:51:54",
          "headline": "'One black, one white, separate and unequal'",
          "small_image_url": "http://www.aljazeera.com/mritems/imagecache/318/480/mritems/images/2014/11/26/20141126790145734_20.jpg",
          "type": "longest",
          "id": 313,
          "video_url": null
        },
        {
          "large_image_url": "http://www.aljazeera.com/mritems/Images/2014/11/29/201411296437903580_20.jpg",
          "byline": "Al Jazeera",
          "description": "Black Friday sales in New York, Chicago, Seattle and San Francisco disrupted by activists angered by jury decision.",
          "pubdate": "2014-11-29T07:40:34",
          "headline": "Ferguson protests target retailers across US",
          "small_image_url": "http://www.aljazeera.com/mritems/imagecache/318/480/mritems/Images/2014/11/29/201411296437903580_20.jpg",
          "type": "latest",
          "id": 242,
          "video_url": null
        },
        {
          "large_image_url": "http://www.aljazeera.com/mritems/Images/2014/11/29/201411296437903580_20.jpg",
          "byline": "Al Jazeera",
          "description": "Black Friday sales in New York, Chicago, Seattle and San Francisco disrupted by activists angered by jury decision.",
          "pubdate": "2014-11-29T07:40:34",
          "headline": "Ferguson protests target retailers across US",
          "small_image_url": "http://www.aljazeera.com/mritems/imagecache/318/480/mritems/Images/2014/11/29/201411296437903580_20.jpg",
          "type": "latest",
          "id": 249,
          "video_url": null
        },
            {
          "large_image_url": "http://www.aljazeera.com/mritems/Images/2014/11/29/201411296437903580_20.jpg",
          "byline": "Al Jazeera",
          "description": "Black Friday sales in New York, Chicago, Seattle and San Francisco disrupted by activists angered by jury decision.",
          "pubdate": "2014-11-29T07:40:34",
          "headline": "Ferguson protests target retailers across US",
          "small_image_url": "http://www.aljazeera.com/mritems/imagecache/318/480/mritems/Images/2014/11/29/201411296437903580_20.jpg",
          "type": "latest",
          "id": 250,
          "video_url": null
        },
        {
          "large_image_url": "http://www.aljazeera.com/mritems/Images/2014/11/29/201411296437903580_20.jpg",
          "byline": "Al Jazeera",
          "description": "Black Friday sales in New York, Chicago, Seattle and San Francisco disrupted by activists angered by jury decision.",
          "pubdate": "2014-11-29T07:40:34",
          "headline": "Ferguson protests target retailers across US",
          "small_image_url": "http://www.aljazeera.com/mritems/imagecache/318/480/mritems/Images/2014/11/29/201411296437903580_20.jpg",
          "type": "latest",
          "id": 251,
          "video_url": null
        }
      ]
    }
  ];

//console.log(results);

//var data = JSON.parse(results)


//console.log("Entitiy name is " + results[0].entity_name);
//console.log("Length is " + results.length);
//console.log("Category is " + results[0].category);
//console.log("Words offset is " + results[0].words_offset)
//console.log("Words offset is " + results[0].entity_name_length)

//for each word, go to the word and color it 

//change the article text to an array of strings

var articleArray = article.split(" ");

//create a loop that goes into each string we want to color and changes it to contain html


//for each entity
for (var i = 0; i <= results.length - 1; i++) {

	//console.log("In first loop. i is " + i + " and results.length is " + results.length);

	//cycle through the words
	for (var j = 0; j <= articleArray.length - 1; j++) {

		//console.log("In second loop. j is " + j + " and articleArray.length is " + articleArray.length);

	//when you get to the first word

	//console.log("Testing to enter first if. Results[i].words_offset" + results[i].words_offset + " and articleArray[j] is " + articleArray[j]);

	if(results[i].words_offset === j+1){

		//console.log("In first if. Results[i].words_offset is" + results[i].words_offset + "and articleArray[j] is " + articleArray[j]);

		//determine which type it is 
		if(results[i].category === "person"){
			//console.log("In person");

			articleArray[j] = '<span style="background-color: #f4bbd6">' + articleArray[j] + '</span>';
			//console.log("Article array now is " + articleArray);
		}
		else if(results[i].category === "thing"){
			//console.log("In person");
			articleArray[j] = '<span style="background-color: #a6dcf4">' + articleArray[j] + '</span>';
			//console.log("Article array now is " + articleArray);
		}
		//place
		else{
			//console.log("In person");
			articleArray[j] = '<span style="background-color: #e3e960">' + articleArray[j] + '</span>';
			//console.log("Article array now is " + articleArray);
		}
	
	}//close if
	
	};//close for loop


};//close for loop

//close the loop and put the html back together using join

var endArticle = articleArray.join(" ");

//console.log("end article is "+ endArticle);

//hide the form
$("#textEditor").hide();
$("#button").hide();

//print the html to the screen
var htmlready = '<p>' + endArticle + '</p>';

//console.log(htmlready);

$("div.container").html(htmlready);

//get the string you want to color
//console.log(articleArray[21]);

//reprint with the colored element


}//close submit function

//console.log("I'm here!");



</script>

<!--<img src="leftsidebar.jpg" align="left" style="width:15%;">
<img src="rightsidebar.jpg" align="right" style="width:20%;">
<img src="topcenter.jpg" style="width:65%">
<img src="middle_content_area2.jpg"  style="width:65%;">
<textarea name="title" rows="2" cols="97" class="form"> title </textarea>-->


<!-- Define the form-->


 <img src="logo.gif" width="100%">
<textarea name="article" rows="30" cols="120" class="form" id="textEditor"> </textarea>
<div class="container">

<!--
<form id="article_template" >
	<input type="text" headline="headline"/>
	<input type="text" article="article"/>
</form>
-->
</div>

<img src="icon.gif" id='button' onClick='submit()'/>



</body>
</html>